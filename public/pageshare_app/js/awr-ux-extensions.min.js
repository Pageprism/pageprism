!function(window,$){"use strict";window.awr=window.awr||{},window.awr.bootQueue=window.awr.bootQueue||[];var console=window.console;function $export(path,exp,opts){opts=opts||{takeEasy:!0,appExport:!0};let sta=window.awr.$static,q=window.awr.Q;return opts.appExport=!0,opts.takeEasy=!q.$booleanFalse(opts.takeEasy),sta.$export(path,exp,opts)}function $import(ref){return window.awr.$static.$import(ref)}function $available(ref){return window.awr.$static.$available(ref)}function $on(eventStr,fn,listenerId){return window.awr.$static.$on(eventStr,fn,listenerId)}function $off(eventStr,fn){return window.awr.$static.$off(eventStr,fn)}function $emit(eventStr,event){return window.awr.$static.$emit(eventStr,event)}function __$loadErrors__(name){return window.awr.$static.$loadErrors(name,!0)}function __$errorOut__(errors,errName,replaces){return window.awr.$static.$errorOut(errors,errName,replaces)}function __onModuleBootTimeoutError__(err){window.console.error("initModule@APP@AWR: Failed to instantiate app module. \n\t + Details: Init process interrupted by timeout. \n\t + Hint: Required components were not ready  before maximum wait time."),window.console.error(err)}function __callModuleMainFn__(mainFn,requires){try{"function"==typeof mainFn&&(!function(requires){return window.awr.Q.$arrayNotEmpty(requires)||window.awr.Q.$objectExist(requires)}(requires)?mainFn.call(window.awr.Q):window.awr.Q.$commonWaitAndProceedOperation(requires,function(){mainFn.call(window.awr.Q)},3e3,__onModuleBootTimeoutError__))}catch(e){console.error(e)}}function __pushToBootQueue__(init){window.awr.bootQueue.push({moduleName:"basicAppModule@AWR",requires:["object:awr.$$appEssentials","object:awr.coreTemplate","object:awr.ux"],wTime:36e5,init:init,QAsContext:!0})}!function(){var __$$requires$$__=[],__$$errors$$__=null;function $errorOut(errName,replaces){return __$errorOut__(__$$errors$$__,errName,replaces)}__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;__$$errors$$__=__$loadErrors__("demoAuthorizer@extensions");const defaultSessionTime=9e5;let userDefinedSessionTime=null,setTimeRequestPass=null;class DemoAuthSvc extends awr.Service{static get $require(){return{serial:"service:serial"}}constructor(){super(DemoAuthSvc.$require)}isAuthorized(){let{serial:serial}=this,t=this.readDemoTime();try{t&&(t=new Date(parseInt(t)))}catch(e){}return Q.$dateExist(t)&&(new Date).getTime()<t.getTime()}authorize(a,b,sessionTime){let{serial:serial}=this,appAuthorizer=$import("service:appDemoAuthorizer"),_self=this;return new Promise(function(resolve,reject){if(!Q.$exist(appAuthorizer)||!Q.$functionExist(appAuthorizer.authorize))return $errorOut("missingAuthorizer"),void reject("Missing dependency appDemoAuthorizer.");try{appAuthorizer.authorize(a,b).then(function(res){Q.$numberExist(sessionTime)&&sessionTime>0?userDefinedSessionTime=sessionTime*=6e4:sessionTime=defaultSessionTime,sessionTime=Q.$numberExist(sessionTime)&&sessionTime>0?sessionTime:defaultSessionTime,setTimeRequestPass=serial.basicPrime.generateOne(),_self.setDemoTime((new Date).getTime()+sessionTime),resolve(res)},function(err){reject(err)})}catch(e){$errorOut("badAuthorizer",[{key:"errMsg",value:e}]),reject(`Authorizer failed to authorize a and b tokens. \n + Details: ${e}`)}})}refreshTime(setPass){let sessionTime=Q.$numberExist(userDefinedSessionTime)&&userDefinedSessionTime>0?userDefinedSessionTime:defaultSessionTime;setTimeRequestPass=setPass,this.setDemoTime((new Date).getTime()+sessionTime)}endTime(){sessionStorage.setItem("awr-demo-time",null)}readDemoTime(){let{serial:serial}=this;try{let alpha,delta,time,bp=serial.basicPrime,v=atob(sessionStorage.getItem("awr-demo-time")),s=v.split("#");return Q.$stringExist(v)&&2===s.length?(alpha=s[0],delta=s[1].substring(s[1].length-4),time=s[1].substring(0,s[1].length-4),bp.check(bp.generateOne({alpha:alpha,delta:delta}))&&Q.$stringExist(time)?parseInt(time):null):null}catch(e){return null}}setDemoTime(t){let s,time,{serial:serial}=this,baseTime=null;try{if(!Q.$stringExist(setTimeRequestPass)||!serial.basicPrime.check(setTimeRequestPass))throw new Error("Forbidden: setting demo time manually is no allowed");setTimeRequestPass=null,time=`${(s=serial.basicPrime.generateOne().split("-"))[0]}#${t}${s[1]}`,baseTime=btoa(time)}catch(e){console.error(`${e.message}`),baseTime=null}return sessionStorage.setItem("awr-demo-time",baseTime),baseTime}}$export(DemoAuthSvc),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class DemoAuthorizer extends awr.Component{static get $require(){return{}}constructor(){super(DemoAuthorizer.$require),this.controller="DemoAuthorizer",this.template="ux/extensions/demo-authorizer/demo-authorizer.hbs",this.scope={sessionTime:"="}}}$export(DemoAuthorizer),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[],__$$errors$$__=null;function $errorOut(errName,replaces){return __$errorOut__(__$$errors$$__,errName,replaces)}__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q,$=$import("window:jQuery"),private_token=null;__$$errors$$__=__$loadErrors__("demoAuthorizer@extensions"),window.errorOut=$errorOut;class DemoAuthorizer extends awr.Controller{static get $require(){return{authSvc:"service:demoAuthSvc",serial:"service:serial",superScope:"object:awr.superScope",screen:"service:browserScreen"}}constructor(data,parent){super(DemoAuthorizer.$require,data,parent);let{authSvc:authSvc,serial:serial,superScope:superScope}=this,scope=this;if(this.authorized=authSvc.isAuthorized(),this.failed=!1,this.success=!1,this.working=!1,private_token=serial.basicPrime.generateOne(),$("body").toggleClass("demo-not-authorized",!this.authorized),Q.$exist(this.sessionTime))try{this.sessionTime=parseInt(this.sessionTime)}catch(e){this.sessionTime=null}this.$addValidationListener(v=>{v.isValid?$(v.element).removeClass("not-valid"):$(v.element).addClass("not-valid")}),setListeners(this,onInput,authSvc),this.authorize=(()=>authorize(this,authSvc)),this.startSession=function(token){if(!Q.$stringExist(private_token)||!Q.$stringEqual(private_token,token))return!1;$("body").removeClass("demo-not-authorized"),$(".animate .block").animate({width:"70%"},{queue:!1,duration:3e3,complete(){scope.authorized=!0,scope.$recompile(),authSvc.refreshTime(serial.basicPrime.generateOne())}})}}mobileGo(event){this.$preventDefault(),event&&13===event.keyCode&&this.authorize()}reset(){this.$preventDefault();let{superScope:superScope}=this;superScope.$recompile()}}function setListeners(scope,fn,authSvc){setTimeout(()=>{$(".demo-authorizer .char-in.a1").on("keyup input",function(e){fn(scope,e.keyCode,"a1","a2",authSvc)}),$(".demo-authorizer .char-in.a2").on("keyup input",function(e){fn(scope,e.keyCode,"a2","a3",authSvc)}),$(".demo-authorizer .char-in.a3").on("keyup input",function(e){fn(scope,e.keyCode,"a3","a4",authSvc)}),$(".demo-authorizer .char-in.a4").on("keyup input",function(e){fn(scope,e.keyCode,"a4","d1",authSvc)}),$(".demo-authorizer .char-in.d1").on("keyup input",function(e){fn(scope,e.keyCode,"d1","d2",authSvc)}),$(".demo-authorizer .char-in.d2").on("keyup input",function(e){fn(scope,e.keyCode,"d2","d3",authSvc)}),$(".demo-authorizer .char-in.d3").on("keyup input",function(e){fn(scope,e.keyCode,"d3","d4",authSvc)}),$(".demo-authorizer .char-in.d4").on("keyup input",function(e){fn(scope,e.keyCode,"d4",null,authSvc)}),$("#resetBtn").on("click",scope.reset)},300)}function onInput(scope,keyCode,key,nxtKey,authSvc){keyCode>=48&&keyCode<=90&&(scope.$validate(key),nxtKey&&$(`.demo-authorizer .char-in.${nxtKey}`).focus(),authorize(scope,authSvc))}function authorize(scope,authSvc){let checkOk,a=`${scope.a1}${scope.a2}${scope.a3}${scope.a4}`,b=`${scope.d1}${scope.d2}${scope.d3}${scope.d4}`,screen=scope.screen;screen&&screen.$width&&screen.$width<=1030&&Q.$stringExist(scope.code)&&(scope.code=scope.code.trim(),a=scope.code.substring(0,4),b=scope.code.substring(4)),(checkOk=a&&b&&4===a.length&&4===b.length)?(scope.working=!0,scope.failed=!1,scope.success=!1,scope.$recompile(),authSvc.authorize(a,b,scope.sessionTime).then(function(){scope.failed=!1,scope.success=!0,scope.working=!1,scope.$recompile(),scope.startSession(private_token)},function(){scope.failed=!0,scope.success=!1,scope.working=!1,scope.$recompile(),setListeners(scope,onInput,authSvc)})):!checkOk&&screen&&screen.$width&&screen.$width<751&&(scope.failed=!0,scope.success=!1,scope.working=!1,scope.$recompile(),setListeners(scope,onInput,authSvc))}$export(DemoAuthorizer),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q,$import("window:jQuery");class DemoTimer extends awr.Component{static get $require(){return{}}constructor(){super(DemoTimer.$require),this.controller="DemoTimer",this.template="ux/extensions/demo-authorizer/demo-timer.hbs",this.scope={}}}$export(DemoTimer),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q,$=$import("window:jQuery");class DemoTimer extends awr.Controller{static get $require(){return{superScope:"object:awr.superScope",authSvc:"service:demoAuthSvc",serial:"service:serial"}}constructor(data,parent){super(DemoTimer.$require,data,parent);let{superScope:superScope,authSvc:authSvc,serial:serial}=this;Q.$numberExist(superScope.demoTimerId)&&clearInterval(superScope.demoTimerId);let timerDom,t=authSvc.readDemoTime(),run=()=>{t=authSvc.readDemoTime(),timerDom=$(this.$getDom()).find(".demo-timer"),t=t?new Date(t):new Date,Q.$dateExist(t)||(t=new Date);let remaining=t.getTime()-(new Date).getTime();this.hours=parseInt(remaining/36e5),this.minutes=parseInt(remaining%36e5/6e4),this.seconds=parseInt(remaining%36e5%6e4/1e3),this.underExpire=remaining<=30500,remaining<=0?(clearInterval(superScope.demoTimerId),superScope.$recompile()):this.underExpire?this.$recompile():($(timerDom).find("span.h").text(this.hours),$(timerDom).find("span.h").toggleClass("add-zero",isSingleDigit(this.hours)),$(timerDom).find("span.m").text(this.minutes),$(timerDom).find("span.m").toggleClass("add-zero",isSingleDigit(this.minutes)),$(timerDom).find("span.s").text(this.seconds),$(timerDom).find("span.s").toggleClass("add-zero",isSingleDigit(this.seconds)))};this.hours="--",this.minutes="--",this.seconds="--",this.isSingleDigit=isSingleDigit,this.$ready(_=>{t=t?new Date(t):new Date,Q.$dateExist(t)||(t=new Date),Q.$numberExist(t.getTime())&&(new Date).getTime()<t.getTime()&&(superScope.demoTimerId=setInterval(run,1e3))})}continueSession(){this.$preventDefault();let{superScope:superScope,authSvc:authSvc,serial:serial}=this;authSvc.refreshTime(serial.basicPrime.generateOne()),superScope.$recompile()}endSession(){this.$preventDefault();let{superScope:superScope,authSvc:authSvc,serial:serial}=this;setTimeout(_=>{authSvc.endTime(),superScope.$recompile()},0)}toLeft(){this.$preventDefault();let container=$(this.$getDom()).find(".demo-timer");$(container).hasClass("pos-left")||($(container).removeClass("pos-right"),$(container).removeClass("pos-left"),container.hasClass("pos-middle")?($(container).removeClass("pos-middle"),$(container).addClass("pos-left")):$(container).addClass("pos-middle"))}toRight(){this.$preventDefault();let container=$(this.$getDom()).find(".demo-timer");$(container).hasClass("pos-right")||($(container).removeClass("pos-right"),$(container).removeClass("pos-left"),container.hasClass("pos-middle")?($(container).removeClass("pos-middle"),$(container).addClass("pos-right")):$(container).addClass("pos-middle"))}}function isSingleDigit(num){return Q.$numberExist(num)&&num<10}$export(DemoTimer),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;const defaultOpts={align:"right",templatePath:null,segment:null,timer:null};class DialogAppender extends awr.Service{static get $require(){return{serial:"service:serial"}}constructor(){super(DialogAppender.$require),this.$importSuperScope()}append(scope,{align:align="right",templatePath:templatePath=null,segment:segment=null,dataContext:dataContext,timer:timer}=defaultOpts){let opts,id,{serial:serial}=this,mkId=()=>`dialog-${Q.$asCollection(serial.bp.generateOne().split("-")).$last()}`;if(Q.$stringExists(templatePath)||Q.$stringExists(segment)){for(opts={selector:`.awr-dialogs .${align=Q.$setContainsString(["right","middle","left"],align)?align:"right"}-container .dialog-items`,isSegment:!0,dataContext:Q.$objectExists(dataContext)?dataContext:{}},Q.$stringExists(templatePath)?opts.templatePath=templatePath:opts.segment=segment,id=mkId();scope.$getAllSegments().$count(nxt=>nxt.dataContext.dialogId===id)>0;)id=mkId();return opts.dataContext.dialogId=id,scope.$append(opts),Q.$numberExists(timer)&&timer>0&&function(scope,dId){setTimeout(_=>{scope.$getAllSegments().each(nxt=>{Q.$idEqual(nxt.dataContext.dialogId,dId)&&(scope.$segment=nxt,scope.closeDialog(),scope.$segment=null)})},timer)}(scope,id),id}console.error("Dialog: Segment or TemplatePath is required for creating new dialog")}}$export(DialogAppender),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class Dialog extends awr.Service{static get $require(){return{}}constructor(){super(Dialog.$require),this.$importSuperScope()}$create(opts){let{superScope:superScope}=this;if(Q.$objectExists(superScope)){if(superScope.$dialogsEnabled&&Q.$functionExists(superScope.$createDialog))return superScope.$createDialog(opts);console.error("Dialog: Dialogs are not enabled on superScope.")}}$close(id){let{superScope:superScope}=this;Q.$objectExists(superScope)&&(superScope.$dialogsEnabled&&Q.$functionExists(superScope.$createDialog)?Q.$idExists(id)?superScope.$closeDialog(id):console.error("Dialog: Dialog ID is required for close."):console.error("Dialog: Dialogs are not enabled on superScope."))}}$export(Dialog),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class Dialogs extends awr.Component{static get $require(){return{}}constructor(){super(Dialogs.$require),this.template="ux/extensions/dialogs/dialogs.hbs",this.controller="Dialogs"}}$export(Dialogs),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class Dialogs extends awr.Controller{static get $require(){return{superScope:"object:awr.superScope",appender:"service:dialogAppender"}}constructor(data,parent){super(Dialogs.$require,data,parent);let{superScope:superScope,serial:serial,appender:appender}=this;this.$disableDefaultActionAutoRecompile(),Object.defineProperty(superScope,"$dialogsEnabled",{get:()=>!0}),superScope.$createDialog=(opts=>appender.append(this,opts)),superScope.$closeDialog=(id=>{Q.$idExists(id)&&this.$getAllSegments().$each(nxt=>{Q.$idEqual(nxt.dataContext.dialogId,id)&&(this.$segment=nxt,this.closeDialog(),this.$segment=null)})})}closeDialog(){let{$segment:$segment}=this;if(Q.$objectExists($segment)){if(Q.$functionExists($segment.dataContext.onClose))try{$segment.dataContext.onClose()}catch(e){console.error(e)}$segment.$remove()}}dialogAction(...args){let{$segment:$segment}=this;if(Q.$objectExists($segment)&&Q.$functionExists($segment.dataContext.onDialogAction))try{$segment.dataContext.onDialogAction.apply(void 0,args)}catch(e){console.error(e)}}}$export(Dialogs),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class FormViewActivator extends awr.Service{static get $require(){return{formCTR:"service:formViewCTR"}}constructor(){super(FormViewActivator.$require)}activate(opts){if(!Q.$objectExist(opts)||!Q.$objectExist(opts.scope))return;let{formCTR:formCTR}=this,form=Q.$stringExist(opts.form)&&$available(`form:${opts.form}`)?$import(`form:${opts.form}`):null;Q.$objectExist(form)&&(opts.formInputArray=Q.$arrayNotEmpty(form.fields)?form.fields:opts.formInputArray,opts.formInputArrayName=Q.$stringExist(form.setName)?form.setName:opts.setName,opts.contextName=form.contextName,opts.maxSteps=form.maxSteps),function(scope,formCTR,opts){if(scope[function(opts){return opts&&Q.$stringExist(opts.formInputArrayName)?opts.formInputArrayName:"formInputs"}(opts)]=Q.$map(function(opts){return opts&&Q.$arrayNotEmpty(opts.formInputArray)?opts.formInputArray:[]}(opts),nxt=>{let mappedNxt;try{mappedNxt=Q.$functionExist(opts.formInputMapFn)?opts.formInputMapFn(nxt):nxt}catch(e){e.message="FormViewActivator setup run into an error.\n\t + Details: bad form input map function."+`Input will be ignored.\n\t + Message: ${e.message}`,console.error(e),mappedNxt=void 0}if(Q.$objectExist(mappedNxt))return mappedNxt.parent=scope,mappedNxt.contextName=Q.$stringExist(mappedNxt.contextName)?mappedNxt.contextName:opts.contextName,mappedNxt}),Q.$functionExist(opts.beforeSetup))try{opts.beforeSetup.call(scope,scope)}catch(e){e.message="FormViewActivator setup run into an error.\n\t + Details: bad beforeSetup callback. "+`\n\t + Message:  ${e.message}`,console.error(e)}scope.formCTRIsCalled||(scope.formCTRIsCalled=!0,formCTR.setup(scope,{validClass:"valid",notValidClass:"not-valid",formDataKey:function(opts){return opts&&Q.$stringExist(opts.contextName)?opts.contextName:"form"}(opts),formInputSelector:function(opts){return opts&&Q.$stringExist(opts.formInputSelector)?opts.formInputSelector:".form-member input, .form-member select"}(opts),maxSteps:opts?opts.maxSteps:null,onSubmit:Q.$functionExist(opts.onSubmit)?opts.onSubmit:item=>{}}))}(opts.scope,formCTR,opts)}}$export(FormViewActivator),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;$import("window:jQuery");class FormViewCTR extends awr.Service{static get $require(){return{formFunctions:"class:FormScopeFunctions@logic@AwrFormEssentials",formVars:"class:FormScopeVars@logic@AwrFormEssentials",formValidation:"class:FormScopeValidation@logic@AwrFormEssentials"}}constructor(){super(FormViewCTR.$require)}getFormViewParams(scope){let params=scope.$getParams();return params.formView=Q.$objectExist(params.formView)?params.formView:{},params.formView}setup(scope,options){(function(scope,{formInputSelector:formInputSelector,validClass:validClass="valid",notValidClass:notValidClass="not-valid",validationClassPosition:validationClassPosition="both",formDataKey:formDataKey="form",maxSteps:maxSteps=Number.MAX_SAFE_INTEGER,onSubmit:onSubmit,init:init}){scope.skipVisited=!1,scope.visitedFields=[],scope.step=0,scope.mode="default",scope.maxSteps=Q.$numberExist(maxSteps)&&maxSteps>=0?maxSteps:Number.MAX_SAFE_INTEGER,scope.__$$defaultFormContextState$$__=function getDefaultContextData(data){let defData={};if(!Q.$objectExist(data))return defData;Q.$each(data,(value,key)=>{Q.$objectExist(value)&&value instanceof Date?defData[key]=value:Q.$objectExist(value)?defData[key]=getDefaultContextData(value):Q.$arrayExist(value)?defData[key]=Q.$map(value,nxt=>nxt):defData[key]=value});return defData}(scope[formDataKey]);let readyListenerId=`form-view-ctr-ready-listener-${scope.$getScopeId()}`,recompileListenerId=`form-view-ctr-recompile-listener-${scope.$getScopeId()}`,validationEventId=`form-view-ctr-validation-listener-${scope.$getScopeId()}`,flushEventId=`form-view-ctr-flush-listener-${scope.$getScopeId()}`,formParams=this.getFormViewParams(scope);this.formVars.setHelperVars(scope),this.formValidation.addValidationListener({scope:scope,validationClassPosition:validationClassPosition,notValidClass:notValidClass,validClass:validClass,validationEventId:validationEventId}),this.formFunctions.defineInitFn({scope:scope,formInputSelector:formInputSelector,init:init,formParams:formParams}),this.formFunctions.defineSubmitFn({scope:scope,onSubmit:onSubmit,formDataKey:formDataKey,formParams:formParams}),this.formFunctions.defineNextStepFn({scope:scope,formParams:formParams}),this.formFunctions.defineBackStepFn({scope:scope,formParams:formParams}),this.formFunctions.defineRestartFn({scope:scope,formDataKey:formDataKey,formParams:formParams}),scope.$ready(scope.init,readyListenerId),scope.$addRecompileListener(scope.init,recompileListenerId),scope.$addFlushListener(evt=>{},flushEventId),scope.$addBeforeRecompileListener(_=>{let stp=parseInt(scope.step);Q.$numberExist(stp)&&stp>scope.maxSteps?scope.step=scope.maxSteps:Q.$numberExist(stp)||(scope.step=0)},"step-max-watcher")}).apply(this,[scope,options])}}$export(FormViewCTR),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){(window.awr||{}).Q;$export("component:awrLooper",{requires:[],template:"ux/extensions/infinite-scroll/awr-looper.hbs",scope:{minIndex:"=",maxIndex:"=",items:"=",itemAs:"=",itemTemplate:"=",itemController:"=",scrollObservable:"="},controller:"AwrLooperController"}),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){(window.awr||{}).Q;$export("controller:AwrLooperController",["service:browserScreen",function(screen){let scope=this;$import("window:jQuery");scope.$getParent().getLooperScope=(()=>scope),scope.$bind(scope.scrollObservable,{scopeName:"scrollEvent",onEvent:(event,preventDefault,isTarget,willRecompile)=>{scope.minIndex=event.minIndex,scope.maxIndex=event.maxIndex}})}]),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){(window.awr||{}).Q;$export("component:infiniteScroll",{requires:[],template:"ux/extensions/infinite-scroll/infinite-scroll.hbs",scope:{items:"=",itemController:"=",itemTemplate:"=",itemScopeType:"=",itemAs:"=",maxCompiledItems:"=",incrementSize:"=",bottomThreshold:"=",topThreshold:"=",bottomStart:"="},controller:"InfiniteScrollController"}),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let Q=(window.awr||{}).Q;function setup(scope){let cont,loopCont,remainHeight;if(setTimeout(_=>$(scope.$getDom()).find(".infinite-loading").addClass("hidden"),500),Q.$functionExist(scope.getLooperScope)){scope.getLooperScope().$addRecompileListener(_=>$(scope.$getDom()).find(".infinite-loading").addClass("hidden"))}Q.$booleanTrue(scope.bottomStart)&&((cont=$(scope.$getDom()).find(".infinite-content")[0]).scrollTo(0,cont.scrollHeight),loopCont=$(scope.$getDom()).find(".loop-cont")[0],remainHeight=$(cont).height(),$(loopCont).find(".message-item").each((nxtId,nxt)=>{remainHeight-=$(nxt).height()}),Q.$numberExist(remainHeight)&&remainHeight>0&&$(loopCont).css("margin-top",remainHeight),$(cont).addClass("bottom-start"))}$export("controller:InfiniteScrollController",["class:Observable@event","service:browserScreen",function(Observable,screen){let lastBottomActual,scope=this,scrollObserverCount=0,lastRecompile=(new Date).getTime(),$=$import("window:jQuery");scope.minIndex=0,scope.maxIndex=Q.$numberExist(scope.maxCompiledItems)?scope.maxCompiledItems:20,scope.$getParent().visibleItemsSize=scope.maxIndex-scope.minIndex,scope.isInfiniteLoop=!0,scope.scrollObservable=new Observable(observer=>{let observerId=`infinite-scroll-observer-${++scrollObserverCount}`;return $on(`${scope.$getScopeId()}:scroll`,event=>{observer.next(event)},observerId),()=>{$off(`${scope.$getScopeId()}:scroll`,observerId)}},`${scope.$getScopeId()}-content-scroll`),scope.$addFlushListener(_=>$off(`${scope.$getScopeId()}:scroll`)),Q.$objectExist(scope.$getParent().setChangeObservable)&&scope.$bind(scope.$getParent().setChangeObservable,{onEvent(event,preventDefault,isTarget,willRecompile){preventDefault(),Q.$arrayExist(event.items)&&(scope.items=event.items,scope.$recompile())}}),Q.$booleanTrue(scope.bottomStart)&&(scope.maxIndex=scope.items.length-1,scope.minIndex=Q.$numberExist(scope.maxCompiledItems)?scope.items.length-scope.maxCompiledItems:scope.items.length-20,scope.minIndex=scope.minIndex<0?0:scope.minIndex),scope.$ready(_=>{setup(scope);let scrollTop,looper=scope.getLooperScope();looper.$addRecompileListener(_=>{let cont=$(scope.$getDom()).find(".infinite-content")[0],loopCont=$(looper.$getDom()).find(".loop-cont")[0];scope.maxIndex<scope.items.length-1&&$(loopCont).height()<=$(cont).height()&&($(looper.$getDom()).find(".vertical-bottom-push").height(1600),setTimeout(_=>{scope.minIndex>0?$(scope.$getDom()).find(".infinite-content")[0].scrollTo(0,170):$(scope.$getDom()).find(".infinite-content")[0].scrollTo(0,0)},600)),scope.minIndex>0&&setTimeout(_=>{(scrollTop=$(scope.$getDom()).find(".infinite-content").scrollTop())<170&&$(scope.$getDom()).find(".infinite-content")[0].scrollTo(0,170)},1e3)})}),scope.$addRecompileListener(_=>setup(scope)),scope.$fn({contentScroll(event){if(scope.$preventDefault(),Q.$booleanTrue(scope.$getParent().scrollDontReact))return;let direction,emit=!1,target=event.target,targetBottom=$(target).offset().top+$(target).outerHeight(),bottomPush=($(target).find(".vertical-top-push")[0],$(target).find(".vertical-bottom-push")[0]),lastItem=$(target).find(".loop-cont > .awr-scope-block").last()[0],bottomActual=bottomPush.offsetTop-target.scrollTop,maxIndex=scope.items.length-1,smoothWait=(new Date).getTime()>lastRecompile+1500,topThreshold=Q.$numberExist(scope.topThreshold)?scope.topThreshold:40,bottomThreshold=Q.$numberExist(scope.bottomThreshold)&&scope.bottomThreshold>targetBottom?scope.bottomThreshold:targetBottom;Q.$numberExist(lastBottomActual)||(lastBottomActual=bottomActual),lastBottomActual<bottomActual?(direction="up",target.scrollTop<=topThreshold&&scope.minIndex>0&&smoothWait&&(scope.minIndex=scope.minIndex-scope.incrementSize,scope.maxIndex-=scope.incrementSize,emit=!0)):(direction="down",$(lastItem).offset().top<=bottomThreshold&&scope.maxIndex<maxIndex&&Q.$booleanTrue(smoothWait)&&(scope.minIndex=scope.maxIndex-scope.incrementSize,scope.maxIndex+=scope.incrementSize,emit=!0)),lastBottomActual=bottomActual,emit&&(scope.$getParent().visibleItemsSize=scope.maxIndex-scope.minIndex,$(scope.$getDom()).find(".infinite-loading").removeClass("hidden"),scope.minIndex<0&&(scope.minIndex=0),scope.maxIndex>maxIndex&&(scope.maxIndex=maxIndex),setTimeout(_=>{Q.$booleanTrue(scope.bottomStart)&&scope.minIndex>0&&target.scrollTop<170?target.scrollTo(0,170):"up"===direction&&scope.minIndex>0&&target.scrollTop<500?target.scrollTo(0,500):"down"===direction&&scope.maxIndex<scope.items.length-1&&target.scrollTo(0,target.scrollHeight/6)},300),$emit(`${scope.$getScopeId()}:scroll`,{minIndex:scope.minIndex,maxIndex:scope.maxIndex,items:scope.items}),lastRecompile=(new Date).getTime())}})}]),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class Modal extends awr.Component{static get $require(){return{}}constructor(){super(Modal.$require),this.controller="Modal",this.template="ux/extensions/modal/modal.hbs",this.scope={}}}$export(Modal),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q,$=$import("window:jQuery");class Modal extends awr.Controller{static get $require(){return{superScope:"object:awr.superScope"}}constructor(data,parent){super(Modal.$require,data,parent);let{superScope:superScope}=this;var event;this.$disableDefaultActionAutoRecompile(),this.$ready(_=>init(this)),this.$addRecompileListener(_=>init(this)),superScope.$enterModal=(event=>{this.modalChildComp=Q.$toDashCase(event.modalChildComp),this.scopeBody=Q.$objectExist(event.scope)?event.scope:{},this.$recompile(),$(this.$getDom()).addClass("on"),$available(`component:${event.modalChildComp}`)||(event=event,console.error(`modal: Failed to open the modal.\n\t+ Details: Required child component [ ${event.modalChildComp} ] cannot be found!`))}),superScope.$exitModal=(event=>{this.scopeBody={},this.modalChildComp=null,this.$recompile(),$(this.$getDom()).removeClass("on")})}modalOff(){let{superScope:superScope}=this;Q.$functionExist(superScope.$exitModal)&&(superScope.$exitModal({signal:"off"}),$emit("modal:signals",{signal:"off"}))}}function init(scope){$(scope.$getDom()).hasClass("awr-modal-parent")||$(scope.$getDom()).addClass("awr-modal-parent"),$(scope.$getDom()).off("click"),$(scope.$getDom()).on("click",function(event){let target=event.target;Q.$isEmpty($(target).closest(".awr-modal-content"))&&scope.modalOff()})}$export(Modal),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},observerCount=(awr.Q,$import("class:Observable@event"),0),observerId=count=>`modal-observer-${count}`;class Modal extends awr.Observable{static get $require(){return{}}constructor(){super(Modal.$require)}makeSubscriber(){return observer=>($on("modal:signals",event=>{observer.next(event)},observerId(++observerCount)),()=>{$off("modal:signals",observerId(observerCount))})}}$export(Modal),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class Modal extends awr.Service{static get $require(){return{}}constructor(){super(Modal.$require),Object.defineProperty(this,"superScope",{get:()=>$import("object:awr.superScope")})}$enter(compName,scopeItems){let{superScope:superScope}=this,event={signal:"on",scope:scopeItems,modalChildComp:Q.$toCamelCase(compName)};Q.$functionExist(superScope.$enterModal)&&(superScope.$enterModal(event),$emit("modal:signals",event))}$exit(){let{superScope:superScope}=this,event={signal:"off"};Q.$functionExist(superScope.$enterModal)&&(superScope.$exitModal(event),$emit("modal:signals",event))}}$export(Modal),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},observerCount=(awr.Q,0);$import("class:Observable@event");class AuthEvents extends awr.Observable{static get $require(){return{}}constructor(){super(AuthEvents.$require)}makeSubscriber(){return observer=>{let observerId=`auth-events-observer-${++observerCount}`;return $on("auth:events",event=>{observer.next(event)},observerId),()=>{$off("auth:events",observerId)}}}}$export(AuthEvents),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q,observerCount=($import("class:Observable@event"),0),observerId=count=>`socket-observer-${count}`;class Socket extends awr.Observable{static get $require(){return{}}constructor(){super(Socket.$require)}makeSubscriber(){return observer=>($on("socket:open@connection",event=>{observer.next(event)},observerId(++observerCount)),$on("socket:close@connection",event=>{observer.next(event)},observerId(observerCount)),function(observerId){getConfig().then(cnf=>{cnf&&!Q.$isEmpty(cnf.channels)&&Q.$forEachIndex(cnf.channels,(nxt,idx)=>{$on(`socket:${nxt}`,event=>{observer.next(event)},observerId)})},err=>{console.error("socketObservable: failed to retrieve socketConnectionConfig."),console.error(err)})}(observerId(observerCount)),()=>{$off("socket:open@connection",observerId(observerCount)),$off("socket:close@connection",observerId(observerCount)),function(observerId){getConfig().then(cnf=>{cnf&&!Q.$isEmpty(cnf.channels)&&Q.$forEachIndex(cnf.channels,(nxt,idx)=>{$off(`socket:${nxt}`,observerId)})},err=>{console.error("socketObservable: failed to retrieve socketConnectionConfig. [@cleanup]"),console.error(err)})}(observerId(observerCount))})}}function getConfig(){return new Promise((resolve,reject)=>{Q.$waitForComps(["config:socketConnection"]).then(_=>{resolve($import("config:socketConnection"))},err=>{reject(err)})},1e4)}$export(Socket),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},observerCount=(awr.Q,$import("class:Observable@event"),0),observerId=count=>`upload-events-observer-${count}`;class UploadEvents extends awr.Observable{static get $require(){return{}}constructor(){super(UploadEvents.$require)}makeSubscriber(){return observer=>($on("uploadManager:progress",event=>{event.type="progress",observer.next(event)},observerId(++observerCount)),$on("uploadManager:complete",event=>{event.type="complete",observer.next(event)},observerId(observerCount)),$on("uploadManager:error",event=>{event.type="error",observer.next(event)},observerId(observerCount)),()=>{$off("uploadManager:progress",observerId(observerCount)),$off("uploadManager:complete",observerId(observerCount)),$off("uploadManager:error",observerId(observerCount))})}}$export(UploadEvents),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class EnableTag extends awr.Pipe{static get $require(){return{}}constructor(){super(EnableTag.$require)}transform(input,...tags){let tr=input;Q.$arrayExists(tags[0])&&(tags=tags[0]);for(let t of tags)Q.$setContainsString(["iframe","script","object","embed","img","image","audio","video","stream"],t)||(tr=whitelist(tr,t));return tr}}function whitelist(value,tag){let openTag=new RegExp(`(.*)&lt;[\\s\\t\\n ]*(${tag})[\\s\\t\\n ]*&gt;(.*)`,"g"),closeTag=new RegExp(`(.*)&lt;[\\s\\t\\n ]*([\\\\/])[\\s\\t\\n ]*(${tag})[\\s\\t\\n ]*&gt;(.*)`,"g");return Q.$exists(value)?`${value}`.replace(openTag,(match,before,group,after)=>`${before}<${group}>${after}`).replace(closeTag,(match,before,sign,group,after)=>`${before}<${sign}${group}>${after}`):""}$export(EnableTag),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class FromBase64 extends awr.Pipe{static get $require(){return{uriBase64:"service:uriBase64"}}constructor(){super(FromBase64.$require)}transform(input){return this.uriBase64.decode(input)}}$export(FromBase64),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class ToBase64 extends awr.Pipe{static get $require(){return{uriBase64:"service:uriBase64"}}constructor(){super(ToBase64.$require)}transform(input){return this.uriBase64.encode(input)}}$export(ToBase64),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let socket,awr=window.awr||{},Q=awr.Q,io=($import("window:jQuery"),$import("window:io"));class SocketClient extends awr.Service{static get $require(){return{socketCnf:"config:socketConnection"}}constructor(){super(SocketClient.$require)}connect(){let{socketCnf:socketCnf}=this;Q.$stringExist(socketCnf.url)?(this.disconnect(),Promise.resolve(socketCnf.socketToken).then(token=>{proceed(socketCnf,token)},err=>{console.error(err),proceed(socketCnf,null)})):console.error("socketClient: Error no connection url is specified in socketConnectionConfig. Aborting.")}disconnect(){let{socketCnf:socketCnf}=this;if(Q.$objectExist(socket))if(Q.$functionExist(socket.disconnect))try{socket.disconnect()}catch(e){console.error(e)}else if(Q.$functionExist(socket.close))try{socket.close()}catch(e){console.error(e)}}}function proceed(socketCnf,token){Q.$stringEqual(socketCnf.clientType,"WebSocket")?proceedWithWebSocket(socketCnf,token):io&&Q.$functionExist(io)?function(socketCnf,token){if((socket=Q.$stringExist(token)?io(`${socketCnf.url}?token=${token}`):io(`${socketCnf.url}`)).on("connect",function(id){$emit("socket:open@connection",{id:socket.id})}),socket.on("disconnect",function(id){$emit("socket:close@connection",{id:socket.id})}),Q.$isEmpty(socketCnf.channels))return void console.error("socketClient: Error no message channel is specified in socketConnectionConfig.");Q.$forEachIndex(socketCnf.channels,(nxt,idx)=>{socket.on(nxt,function(data){$emit(`socket:${nxt}`,data)})})}(socketCnf,token):(console.warn("socket: IO driver not found, falling back to default WebSocket instead."),proceedWithWebSocket(socketCnf,token))}function proceedWithWebSocket(socketCnf,token){let url=Q.$stringExist(token)?`${socketCnf.url}?token=${token}`:socketCnf.url;(socket=new WebSocket(url)).addEventListener("open",function(event){$emit("socket:open@connection",event)}),socket.addEventListener("close",function(event){$emit("socket:close@connection",event)}),Q.$isEmpty(socketCnf.channels)?console.error("socketClient: Error no message channel is specified in socketConnectionConfig."):Q.$forEachIndex(socketCnf.channels,(nxt,idx)=>{socket.addEventListener(nxt,function(event){$emit(`socket:${nxt}`,data)})})}$export(SocketClient),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class UploadManager extends awr.Service{static get $require(){return{server:"service:serverCall"}}constructor(){super(UploadManager.$require)}uploadMultipleFiles({url:url,token:token,fileKey:fileKey,files:files,data:data}){let{server:server}=this;return files&&files instanceof FileList&&files.length>0?create$UploadJob({server:server,url:url,fileKey:fileKey,file:files,token:token,data:data}):Promise.reject("bad upload files")}upload({url:url,token:token,fileKey:fileKey,files:files,data:data}){let{server:server}=this,set=Q.$asCollection([]);if(files&&files instanceof FileList)for(let f of files)set.push(f);else Q.$isEmpty(files)||(set=Q.$asCollection(files));return set.$isEmpty()?Promise.reject("bad upload files"):function({server:server,url:url,fileKey:fileKey,files:files,token:token,data:data}){let flatSet=Q.$asCollection([]);return files.$each(nxt=>{if(nxt instanceof File)flatSet.push(nxt);else if(nxt instanceof FileList)for(let f of nxt)flatSet.push(f)}),Promise.all(flatSet.$map(nxt=>{if(nxt instanceof File)return create$UploadJob({server:server,url:url,fileKey:fileKey,file:nxt,token:token,data:data})}))}({server:server,url:url,fileKey:fileKey,files:set,token:token,data:data})}}function create$UploadJob({server:server,url:url,fileKey:fileKey,file:file,token:token,data:data}){let nxtData={};return nxtData[fileKey]=file,Q.$objectExists(data)&&Q.$each(data,(val,fileKey)=>{nxtData[fileKey]=val}),new Promise((resolve,reject)=>{server.$upload({url:url,data:nxtData,headers:{authorization:token},progress(event){$emit("uploadManager:progress",{file:nxtData[fileKey],track:event})}}).then(res=>{$emit("uploadManager:complete",{file:nxtData[fileKey],result:res}),resolve(res)},err=>{$emit("uploadManager:error",{file:nxtData[fileKey],error:err}),reject(err)})})}$export(UploadManager),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class UriBase64 extends awr.Service{static get $require(){return{}}constructor(){super(UriBase64.$require)}encode(cmp){let res;try{res=window.encodeURIComponent(function(cmp){if(!Q.$stringExist(cmp)&&!Q.$numberExist(cmp))return"";return window.btoa(cmp).replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/=+$/,"")}(cmp))}catch(e){res=null}return res}decode(cmp,convertNumbers){let res,num;try{res=function(cmp){if(!Q.$stringExist(cmp))return"";let paddingCount=3-(3+(cmp=cmp.replace(/[-]/g,"+").replace(/[_]/g,"/")).length)%4;return window.atob(`${cmp}${"=".repeat(paddingCount)}`)}(window.decodeURIComponent(cmp))}catch(e){res=null}return num=res?parseInt(res):null,Q.$booleanTrue(convertNumbers)&&Q.$numberExist(num)&&(res=num),res}}$export(UriBase64),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class Email extends awr.Validator{static get $require(){return{}}constructor(){super(Email.$require)}isValid(val,elem){let regex=new RegExp(/.+@.+\..+/,"g");return Q.$stringExist(val)&&regex.test(val)}}$export(Email),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class Letter extends awr.Validator{static get $require(){return{}}constructor(){super(Letter.$require)}isValid(val,elem){let hasLetter=new RegExp(/[A-Za-z]+/,"g");return(v=>v&&1===v.length&&hasLetter.test(v))(val)}}$export(Letter),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class Number extends awr.Validator{static get $require(){return{}}constructor(){super(Number.$require)}isValid(val,elem){let min,max,regex=new RegExp(/[0-9]+/,"g");try{min=parseInt($(elem).attr("min")),min=isNaN(min)?1:min}catch(e){min=1}try{max=parseInt($(elem).attr("max")),max=isNaN(max)?-1:max}catch(e){max=-1}return max>-1?Q.$stringExist(val)&&regex.test(val)&&val.length>=min&&val.length<=max:Q.$stringExist(val)&&regex.test(val)&&val.length>=min}}$export(Number),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class PasswordConfirm extends awr.Validator{static get $require(){return{}}constructor(){super(PasswordConfirm.$require)}isValid(val,elem,compare){return Q.$exist(val)&&Q.$exist(compare)&&val===compare}}$export(PasswordConfirm),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class Password extends awr.Validator{static get $require(){return{}}constructor(){super(Password.$require)}isValid(val,elem){let min,max,hasANumber=new RegExp(/.*[0-9]+.*/,"g"),hasALetter=new RegExp(/.*[a-z]+.*/,"g"),hasACapital=new RegExp(/.*[A-Z]+.*/,"g"),testPass=v=>hasANumber.test(v)&&hasACapital.test(v)&&hasALetter.test(v);try{min=parseInt($(elem).attr("min")),min=isNaN(min)?3:min}catch(e){min=3}try{max=parseInt($(elem).attr("max")),max=isNaN(max)?-1:max}catch(e){max=-1}return max>-1?Q.$stringExist(val)&&testPass(val)&&val.length>=min&&val.length<=max:Q.$stringExist(val)&&testPass(val)&&val.length>=min}}$export(Password),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class Phone extends awr.Validator{static get $require(){return{}}constructor(){super(Phone.$require)}isValid(val,elem){let regex=new RegExp(/\+{0,1}[0-9]+[-]{0,1}[0-9]+/,"g");return Q.$stringExist(val)&&val.replace(/[+-]/,"").length>3&&!val.endsWith("-")&&!val.match(/[A-Za-z.,!"'*]+/,"g")&&!val.substring(1).match(/[+]+/,"g")&&regex.test(val)}}$export(Phone),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class SingleDigit extends awr.Validator{static get $require(){return{}}constructor(){super(SingleDigit.$require)}isValid(val,elem){let hasDigit=new RegExp(/[0-9]+/,"g");return(v=>v&&1===v.length&&hasDigit.test(v))(val+"")}}$export(SingleDigit),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class String extends awr.Validator{static get $require(){return{}}constructor(){super(String.$require)}isValid(val,elem){let min,max;try{min=parseInt($(elem).attr("min")),min=isNaN(min)?1:min}catch(e){min=1}try{max=parseInt($(elem).attr("max")),max=isNaN(max)?-1:max}catch(e){max=-1}return max>-1?Q.$stringExist(val)&&val.length>=min&&val.length<=max:Q.$stringExist(val)&&val.length>=min}}$export(String),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q;class Url extends awr.Validator{static get $require(){return{}}constructor(){super(Url.$require)}isValid(val,elem){let regex=new RegExp(/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/);return Q.$stringExist(val)&&(regex.test(val)||val.startsWith("http://localhost")||val.startsWith("https://localhost")||val.startsWith("localhost"))}}$export(Url),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class AwrRate extends awr.Component{static get $require(){return{}}constructor(){super(AwrRate.$require),this.controller="AwrRate",this.template="ux/extensions/formEssentials/awr-rate/awr-rate.hbs",this.scope={currentRate:"=",max:"=",onRate:"="}}}$export(AwrRate),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q,$=$import("window:jQuery");class AwrRate extends awr.Controller{static get $require(){return{}}constructor(data,parent){super(AwrRate.$require,data,parent),this.currentRate=Q.$numberExist(this.currentRate)?this.currentRate:0,this.max=Q.$numberExist(this.max)&&this.max>0?this.max:10,this.rateInfo={name:"rate-info"},this.stars=[];for(let i=0;i<this.max;i++)this.stars.push({name:"starItem",position:i+1,icon:"far fa-star",hIcon:"fas fa-star"});this.starSetup=(item=>{let current=this.currentRate;current<item.position?item.icon="far fa-star":current>item.position&&current<=item.position+.5?item.icon="fas fa-star-half-alt":item.icon="fas fa-star"}),this.rateInfoSetup=(item=>{item.current=this.currentRate,item.max=this.max})}hover(position){Q.$functionExist(this.$preventDefault)&&this.$preventDefault(),$(this.$getDom()).find(".star-container").toggleClass("h",this.currentRate>0&&position>=0),Q.$each($(this.$getDom()).find(".star-container .r-item"),nxt=>{$(nxt).toggleClass("h",$(nxt).data("position")<=position)})}rate(position){if(Q.$functionExist(this.$preventDefault)&&this.$preventDefault(),Q.$numberExist(position)&&position>=0&&position<=this.max&&(this.currentRate=position),this.$getAllSegments().$each(nxt=>{nxt.$update()}),Q.$functionExist(this.onRate))try{this.onRate(this.currentRate)}catch(err){}}}$export(AwrRate),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class FormMember extends awr.Component{static get $require(){return{}}constructor(){super(FormMember.$require),this.controller="FormMember",this.template="ux/extensions/formEssentials/form-member/form-member.hbs",this.scope={contextName:"=",key:"=",icon:"=",cssClass:"=",parentCssClass:"=",validator:"=",validationMessage:"=",type:"=",placeholder:"=",elementAttrs:"=",parent:"=",options:"=",label:"=",onSearch:"=",title:"=",description:"=",required:"=",defaultValue:"=",max:"=",currentRate:"=",labelLinks:"=",showFileSize:"="}}}$export(FormMember),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q,$=$import("window:jQuery");class FormMember extends awr.Controller{static get $require(){return{setup:"class:FormMemberSetup@logic@AwrFormEssentials",utils:"class:FormMemberUtils@logic@AwrFormEssentials",superScope:"object:awr.superScope"}}constructor(data,parentCtr){super(FormMember.$require,data,parentCtr);let parentParams,{utils:utils,setup:setup}=this,scopeParams=this.$getParams();this.$enablePreferScopeForDataBinding(),setup.initFormMember(this,utils),parentParams=this.parentParams,this.$ready(_=>{$(this.$getDom()).addClass("form-member-parent"),$(this.$getDom()).toggleClass("hz-layout",Q.$booleanTrue(this.hasHorizontalLayout)),Q.$stringExist(this.parentCssClass)&&$(this.$getDom()).addClass(this.parentCssClass),parentParams.$$validations=Q.$arrayExist(parentParams.$$validations)?parentParams.$$validations:[],parentParams.$$validations=Q.$reduce(parentParams.$$validations,nxt=>nxt.key!==this.key),parentParams.$$validations.push(scopeParams.$$validations[0]),Q.$forEachProperty(this.elementAttrs,(val,key)=>{$(this.$getDom()).find('[target="yes"]').each(function(){$(this).attr(key,val)})})},"form-member-main-ready-routines"),this.$init(_=>{utils.restoreExistingFiles(this),utils.initCheckboxState(this)}),this.$addBeforeRecompileListener(_=>{Q.$setContainsString(["file","pretty-file"],this.type)&&utils.saveExistingFiles(this)},"form-member-before-recompile-routines")}fileTriggerInFormMember(){Q.$functionExist(this.$preventDefault)&&this.$preventDefault(),$(this.$getDom()).find('.pretty-file-type input[type="file"]').trigger("click")}fileChangeInFormMember(event){Q.$functionExist(this.$preventDefault)&&this.$preventDefault();let{utils:utils}=this;utils.handleFileChange(event,this)}removeFileInFormMember(){Q.$functionExist(this.$preventDefault)&&this.$preventDefault(),Q.$setContainsString(["file","pretty-file"],this.type)&&(this.dataContext[this.key]=null,this.$recompile())}actOnLabelPartInFormMember(link){Q.$functionExist(this.$preventDefault)&&this.$preventDefault();let fnName,{superScope:superScope}=this;if(Q.$stringExists(link)&&link.startsWith("action:")){if(fnName=link.split(":")[1],!Q.$stringExists(fnName)||!Q.$functionExists(superScope[fnName]))return;try{superScope[fnName]()}catch(e){console.error(e)}}else Q.$stringExist(link)&&window.open(link,"_blank")}}$export(FormMember),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let Q=(window.awr||{}).Q,$=$import("window:jQuery");const inputTypes=["checkbox","color","date","datetime","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];$export("class:FormMemberSetup@logic@AwrFormEssentials",class{constructor(){}static initFormMember(scope,utils){let parent=scope.$getParent();Q.$objectExist(scope.parent)&&Q.$functionExist(scope.parent.$getScopeId)&&(parent=scope.parent),scope.parentParams=parent.$getParams(),scope.name=scope.key,scope.type=Q.$stringExist(scope.type)?scope.type:"input",scope.dataContext=parent[scope.contextName],scope.noIcon=!Q.$stringExist(scope.icon),Q.$objectExist(scope.dataContext)||(parent[scope.contextName]={},scope.dataContext=parent[scope.contextName]),scope.elementAttrs=utils.getElementAttrs(scope.elementAttrs),"horizontal-radio-group"===scope.type&&(scope.type="radio-group",scope.hasHorizontalLayout=!0),Q.$setContainsString(inputTypes,scope.type)?(scope.elementAttrs.type=scope.type,"checkbox"!==scope.type&&(scope.type="input")):Q.$stringEqual(scope.type,"input")&&!Q.$stringExist(scope.elementAttrs.type)&&(scope.elementAttrs.type="text"),scope.label=Q.$stringExist(scope.label)?Q.$capitalizeFirstLetter(scope.label):"",scope.placeholder=Q.$capitalizeFirstLetter(scope.placeholder),scope.cssGroup=Q.$stringEqual(scope.type,"input")?`${scope.elementAttrs.type}-type`:`${scope.type}-type`,Q.$stringExist(scope.cssClass)&&(scope.cssGroup+=` ${scope.cssClass}`),scope.options=Q.$asCollection(Q.$arrayExist(scope.options)?scope.options:[]),"select"!==scope.type&&Q.$each(scope.options,nxt=>{Q.$objectExist(nxt)&&(nxt.dataContext=scope.dataContext)}),"select"===scope.type&&(Q.$stringExist(scope.placeholder)&&!scope.options.$contains("value","__$$placeholder$$__")&&(scope.options.reverse(),scope.options.push({displayValue:scope.placeholder,value:"__$$placeholder$$__"}),scope.options.reverse()),scope.options=Q.$map(scope.options,nxt=>Q.$objectExist(nxt)?(nxt.hasOwnProperty("displayValue")&&Q.$stringExist(nxt.displayValue)||(nxt.displayValue=nxt.value),nxt):{value:nxt,displayValue:nxt})),"checkbox"===scope.type&&(scope.labelLinks=Q.$isEmpty(scope.labelLinks)?Q.$asCollection([]):Q.$asCollection(scope.labelLinks),scope.labelParts=Q.$asCollection(scope.label.split(" ")).$map(nxt=>{let l={value:nxt,isLink:!1,link:null,isWord:!new RegExp(/[,.!?+:;]/).test(nxt)};return scope.labelLinks.$contains("key",nxt)&&((l=scope.labelLinks.$find("key",nxt)).isLink=!0,l.isWord=!0),l})),"rate"===scope.type&&(Q.$numberExist(scope.dataContext[scope.key])||(scope.dataContext[scope.key]=0),scope.currentRate=scope.dataContext[scope.key],scope.onRate=(r=>{scope.dataContext[scope.key]=r})),"tag-field"===scope.type&&(scope.items=scope.dataContext[scope.key],scope.onAdd=((all,item)=>{Q.$objectExist(scope.dataContext)&&Q.$stringExist(scope.key)&&(scope.dataContext[scope.key]=all,scope.items=scope.dataContext[scope.key],$(scope.$getDom()).find(".form-member").removeClass("not-valid"))}),scope.onRemove=((all,item)=>{Q.$objectExist(scope.dataContext)&&Q.$stringExist(scope.key)&&(scope.dataContext[scope.key]=all,scope.items=scope.dataContext[scope.key],Q.$booleanTrue(scope.required)&&Q.$isEmpty(all)?$(scope.$getDom()).find(".form-member").addClass("not-valid"):$(scope.$getDom()).find(".form-member").removeClass("not-valid"))})),scope.placeholder="pretty-file"!==scope.type||Q.$stringExist(scope.placeholder)?scope.placeholder:"No file selected",Q.$setContainsString(["file","pretty-file"],scope.type)&&utils.saveExistingFiles(scope)}}),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let Q=(window.awr||{}).Q,$=$import("window:jQuery");class FormMemberUtils{constructor(){}static initCheckboxState(scope){Q.$stringEqual("checkbox",scope.type)&&Q.$booleanTrue(scope.dataContext[scope.key])&&$(scope.$getDom()).find('input[type="checkbox"]').trigger("click")}static saveExistingFiles(scope){scope.dataContext[scope.key]instanceof FileList&&scope.dataContext[scope.key].length>0&&(scope.__saved_files__=scope.dataContext[scope.key]),scope.dataContext[scope.key]=null}static restoreExistingFiles(scope){if(Q.$setContainsString(["file","pretty-file"],scope.type)&&Q.$objectExist(scope.__saved_files__)){scope.dataContext[scope.key]=scope.__saved_files__;let fileName=Q.$objectExist(scope.__saved_files__[0])&&Q.$stringExists(scope.__saved_files__[0].name)?scope.__saved_files__[0].name.split("\\").pop():"",size=FormMemberUtils.getFileSize(scope.__saved_files__[0]);$(scope.$getDom()).find('.pretty-file-type input[type="file"]')[0].files=scope.__saved_files__,$(scope.$getDom()).find(".pretty-file-type").addClass("has-file"),$(scope.$getDom()).find(".pretty-file-type .file-name .name").text(fileName),scope.showFileSize&&Q.$stringExist(size)?($(scope.$getDom()).find(".pretty-file-type .file-name .size").text(size),$(scope.$getDom()).find(".pretty-file-type .file-name .size").removeClass("hidden")):($(scope.$getDom()).find(".pretty-file-type .file-name .size").text(""),$(scope.$getDom()).find(".pretty-file-type .file-name .size").addClass("hidden")),delete scope.__saved_files__}}static handleFileChange(event,scope){let fileName=event.target.value?event.target.value.split("\\").pop():"",size=FormMemberUtils.getFileSize($(scope.$getDom()).find('.pretty-file-type input[type="file"]')[0]);Q.$stringExist(fileName)?($(scope.$getDom()).find(".pretty-file-type").addClass("has-file"),$(scope.$getDom()).find(".pretty-file-type .file-name .name").text(fileName),scope.showFileSize&&Q.$stringExist(size)?($(scope.$getDom()).find(".pretty-file-type .file-name .size").text(size),$(scope.$getDom()).find(".pretty-file-type .file-name .size").removeClass("hidden")):($(scope.$getDom()).find(".pretty-file-type .file-name .size").text(""),$(scope.$getDom()).find(".pretty-file-type .file-name .size").addClass("hidden"))):$(scope.$getDom()).find(".pretty-file-type").removeClass("has-file")}static getFileSize(elem){if(!(Q.$objectExist(elem)&&elem instanceof File||elem&&elem.files&&elem.files.length>0))return null;let file=Q.$objectExist(elem)&&elem instanceof File?elem:elem.files[0];return Q.$asFileSize(Q.$exists(file)?file.size:null)}static getElementAttrs(str){let elementAttrs={};return Q.$stringExist(str)&&Q.$forEachIndex(str.split(" "),(nxt,index)=>{let nxtArr=nxt.split("="),nxtKey=nxt.split("=")[0],nxtVal=null;nxtArr.length>1&&(nxtVal=nxt.split("=")[1]),elementAttrs[nxtKey]=nxtVal}),elementAttrs}}$export("class:FormMemberUtils@logic@AwrFormEssentials",FormMemberUtils),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let Q=(window.awr||{}).Q,$=$import("window:jQuery");function callLater(fn,callTime){(new Date).getTime()<callTime?setTimeout(_=>{fn()},250):fn()}$export("class:FormScopeFunctions@logic@AwrFormEssentials",class{constructor(){}static defineInitFn({scope:scope,formInputSelector:formInputSelector,init:init,formParams:formParams}){scope.$fn({init(){return this.$preventDefault(),function({scope:scope,formInputSelector:formInputSelector,scopeInit:scopeInit}){return function(){let passwordCompare,dom=$(scope.$getDom()).find(formInputSelector);if($(dom).on("focusout",function(){scope.visitedFields.includes($(this).attr("name"))||scope.visitedFields.push($(this).attr("name")),"passwordConfirm"===$(this).attr("name")?(passwordCompare=$(scope.$getDom()).find('[name="password"]').val(),scope.$validate($(this).attr("name"),passwordCompare)):scope.$validate($(this).attr("name"))}),$(dom).on("keyup input keypress change keydown keyup propertychange",function(){"passwordConfirm"===$(this).attr("name")?(passwordCompare=$(scope.$getDom()).find('[name="password"]').val(),scope.$validate($(this).attr("name"),passwordCompare)):scope.$validate($(this).attr("name"))}),Q.$functionExist(scopeInit))try{scopeInit()}catch(e){console.error(`formViewCTR@AWR: Error in the init@scope. \n\t + Details: ${e}`)}}}({scope:this,formInputSelector:formInputSelector,visitedFields:this.visitedFields,scopeInit:init})()}})}static defineSubmitFn({scope:scope,onSubmit:onSubmit,formDataKey:formDataKey,formParams:formParams}){scope.$fn({submit:function(){if(this.$preventDefault(),formParams.isSubmitBusy)return;let callTime;var scope,formParamsObj;formParams.isSubmitBusy=!0,scope=this,formParamsObj=formParams,Q.$nonBlocking(_=>{scope.skipVisited=!0;let validation=scope.$validate();(!Q.$arrayExist(validation.errors)||validation.errors.length<1)&&(scope.mode="working",scope.$recompile(),callTime=(new Date).getTime()+500,Q.$functionExist(onSubmit)?Promise.resolve(onSubmit(scope[formDataKey])).then(result=>{scope.submitResult=result,scope.mode="success",callLater(()=>{scope.$recompile(),scope.init()},callTime)},err=>{scope.submitErr=err,scope.mode="fail",callLater(()=>{scope.$recompile(),scope.init()},callTime)}):(scope.submitErr="no submit function found!",scope.mode="fail",callLater(()=>{scope.$recompile()},callTime))),setTimeout(_=>{scope.skipVisited=!1,formParamsObj.isSubmitBusy=!1},500)},"Form view < submit > function failed",scope.$getScopeId())}})}static defineNextStepFn({scope:scope,formParams:formParams}){scope.$fn({nextStep(){var scope,formParamsObj;this.$preventDefault(),formParams.isNextStepBusy||(formParams.isNextStepBusy=!0,scope=this,formParamsObj=formParams,Q.$nonBlocking(()=>{if(Q.$numberExist(scope.step)&&scope.step+1>scope.maxSteps)return void(formParamsObj.isNextStepBusy=!1);scope.skipVisited=!0;let newStep,currentStepOk,validation={},validationKeys=Q.$numberExist(scope.step)&&!Q.$isEmpty(scope.stepsValidation)?scope.stepsValidation[scope.step]:null;newStep=Q.$numberExist(scope.step)&&scope.step>=0?scope.step+1:0,Q.$arrayExist(validationKeys)&&(validation=scope.$validate(validationKeys)),(currentStepOk=Q.$isEmpty(validation.errors)||Q.$isEmpty(validationKeys)||Q.$asCollection(validation.errors).$count(nxt=>Q.$setContainsString(validationKeys,nxt.key))<1)&&(scope.step=newStep,scope.$recompile(),scope.init()),scope.skipVisited=!1,formParamsObj.isNextStepBusy=!1},"Form view < nextStep > function failed",scope.$getScopeId()))}})}static defineBackStepFn({scope:scope,formParams:formParams}){scope.$fn({backStep(){var scope,formParamsObj;this.$preventDefault(),formParams.isBackStepBusy?console.log("busy back"):(formParams.isBackStepBusy=!0,scope=this,formParamsObj=formParams,Q.$nonBlocking(()=>{Q.$numberExist(scope.step)&&0===scope.step?formParamsObj.isBacktSepBusy=!1:(Q.$numberExist(scope.step)&&scope.step>0?scope.step-=1:scope.step=0,scope.$recompile(),scope.init(),formParamsObj.isBackStepBusy=!1)},"Form view < backStep > function failed",scope.$getScopeId()))}})}static defineRestartFn({scope:scope,formDataKey:formDataKey,formParams:formParams}){scope.$fn({restart(keepData){this.$preventDefault(),keepData=Q.$booleanTrue(keepData),formParams.isRestartBusy||(formParams.isRestartBusy=!0,function(scope,keepData,formDataKey,formParamsObj){Q.$nonBlocking(()=>{keepData||(scope[formDataKey]=scope.__$$defaultFormContextState$$__),scope.step=0,scope.mode="default",scope.submitResult=null,scope.submitErr=null,scope.visitedFields=[],scope.skipVisited=!1,formParamsObj.isRestartBusy=!1,scope.$recompile()},"Form view < restart > function failed",scope.$getScopeId())}(this,keepData,formDataKey,formParams))}})}}),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){(window.awr||{}).Q;let $=$import("window:jQuery");function toggleClasses(v,classPosition,addClass,removeClass){"both"===classPosition?($(v.element).parent().addClass(addClass),$(v.element).parent().removeClass(removeClass),$(v.element).addClass(addClass),$(v.element).removeClass(removeClass)):"parent"===classPosition?($(v.element).parent().addClass(addClass),$(v.element).parent().removeClass(removeClass)):($(v.element).addClass(addClass),$(v.element).removeClass(removeClass))}$export("class:FormScopeValidation@logic@AwrFormEssentials",class{constructor(){}static addValidationListener({scope:scope,validationClassPosition:validationClassPosition,notValidClass:notValidClass,validClass:validClass,validationEventId:validationEventId}){scope.$addValidationListener(v=>{let visitedFields=scope.visitedFields,skipVisited=v.skipVisited,failCond=!v.isValid&&(visitedFields.includes($(v.element).attr("name"))||skipVisited),successCond=v.isValid&&(visitedFields.includes($(v.element).attr("name"))||skipVisited);failCond?toggleClasses(v,validationClassPosition,notValidClass,validClass):successCond?toggleClasses(v,validationClassPosition,validClass,notValidClass):toggleClasses(v,validationClassPosition,"",`${notValidClass} ${validClass}`)},validationEventId)}}),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let Q=(window.awr||{}).Q;$import("window:jQuery");$export("class:FormScopeVars@logic@AwrFormEssentials",class{constructor(){}static setHelperVars(scope){scope.fieldInCurrentStep=(nxt=>Q.$objectExist(nxt)&&scope.step==nxt.step),delete scope.stepPlus,Object.defineProperty(scope,"stepPlus",{get:()=>scope.step+1,configurable:!0}),delete scope.maxStepsPlus,Object.defineProperty(scope,"maxStepsPlus",{get:()=>scope.maxSteps+1,configurable:!0}),delete scope.hasSubmit,Object.defineProperty(scope,"hasSubmit",{get:()=>scope.step===scope.maxSteps&&"default"===scope.mode,configurable:!0}),delete scope.hasBack,Object.defineProperty(scope,"hasBack",{get:()=>scope.step>0&&"default"===scope.mode,configurable:!0}),delete scope.hasNext,Object.defineProperty(scope,"hasNext",{get:()=>scope.step<scope.maxSteps&&"default"===scope.mode,configurable:!0}),delete scope.inDefaultMode,Object.defineProperty(scope,"inDefaultMode",{get:()=>"default"===scope.mode,configurable:!0}),delete scope.inWorkingMode,Object.defineProperty(scope,"inWorkingMode",{get:()=>"working"===scope.mode,configurable:!0}),delete scope.inFailMode,Object.defineProperty(scope,"inFailMode",{get:()=>"fail"===scope.mode,configurable:!0}),delete scope.inSuccessMode,Object.defineProperty(scope,"inSuccessMode",{get:()=>"success"===scope.mode,configurable:!0})}}),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{};awr.Q;class TagField extends awr.Component{static get $require(){return{}}constructor(){super(TagField.$require),this.controller="TagField",this.template="ux/extensions/formEssentials/tag-field/tag-field.hbs",this.scope={placeholder:"=",onSearch:"=",onAdd:"=",onRemove:"=",validator:"=",items:"="}}}$export(TagField),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}(),function(){var __$$requires$$__=[];__pushToBootQueue__(function(){let awr=window.awr||{},Q=awr.Q,$=$import("window:jQuery");class TagField extends awr.Controller{static get $require(){return{}}constructor(data,parent){super(TagField.$require,data,parent),this.items=Q.$isEmpty(this.items)?Q.$asCollection([]):Q.$asCollection(this.items),this.placeholder=Q.$stringExist(this.placeholder)?this.placeholder:"Add new tag",this.hasSuggestions=!1,this.$ready(_=>{init(this)}),this.$addRecompileListener(_=>{init(this),$(this.$getDom()).find('.tag-field input[type="text"]').focus()})}pickSuggestion(event){if(Q.$functionExist(this.$preventDefault)&&this.$preventDefault(),!this.hasSuggestions)return;let idx=$(this.$getDom()).find(".suggestions span.selected").index(),all=$(this.$getDom()).find(".suggestions span");event&&38===event.keyCode?idx--:event&&40===event.keyCode&&idx++,idx<0&&(idx=$(all).length-1),idx=idx>=0&&idx<$(all).length?idx:0,$(all).removeClass("selected"),$(this.$getDom()).find(`.suggestions span:nth-of-type(${idx+1})`).addClass("selected")}removeTag(tagName){Q.$functionExist(this.$preventDefault)&&this.$preventDefault();let exist=tagName&&this.items.$map(nxt=>nxt.toLowerCase()).$contains(tagName.toLowerCase().trim());if(Q.$stringExist(tagName)&&exist){if(this.items=this.items.$reduce(nxt=>nxt.toLowerCase()!==tagName.toLowerCase().trim()),Q.$functionExist(this.onRemove))try{this.onRemove(this.items,tagName.trim())}catch(e){console.error("Tag field: bad onRemove listener"),console.error(e)}setTimeout(_=>{this.$recompile()},0)}}addTag(event){Q.$functionExist(this.$preventDefault)&&this.$preventDefault();let exist,sugg,input=$(event.target),val=$(input).val();if(event&&13===event.keyCode&&this.hasSuggestions&&(sugg=$(this.$getDom()).find(".suggestions span.selected").text(),val=Q.$stringExist(sugg)?sugg:val),exist=val&&this.items.$map(nxt=>nxt.toLowerCase()).$contains(val.toLowerCase().trim()),event&&40===event.keyCode||38===event.keyCode)this.pickSuggestion(event);else{if(!Q.$stringExist(val)||!event)return this.search(null),void(event&&8===event.keyCode&&this.items.length>0&&this.removeTag(this.items.$last()));if(exist||13===event.keyCode){if(13===event.keyCode&&!exist){if(this.items.push(val.trim()),Q.$functionExist(this.onAdd))try{this.onAdd(this.items,val.trim())}catch(e){console.error("Tag field: bad onAdd listener"),console.error(e)}setTimeout(_=>{this.$recompile()},0)}}else this.search(val.trim())}}search(val){if(Q.$functionExist(this.$preventDefault)&&this.$preventDefault(),!Q.$stringExist(val)||!Q.$functionExist(this.onSearch))return this.hasSuggestions=!1,void $(this.$getDom()).find(".tag-field").removeClass("has-suggestions");try{Promise.resolve(this.onSearch(val)).then(res=>{if(res=Q.$isEmpty(res)?Q.$asCollection([]):Q.$asCollection(res).$map(nxt=>{if(Q.$objectExist(nxt)&&(nxt=nxt.value?nxt.value:nxt.tag?nxt.tag:nxt.name?nxt.name:nxt.content?nxt.content:nxt.text?nxt.text:nxt),Q.$stringExist(nxt)||Q.$numberExist(nxt))return nxt}),$(this.$getDom()).find(".suggestions").html(""),res.$count()<1)return this.hasSuggestions=!1,void $(this.$getDom()).find(".tag-field").removeClass("has-suggestions");this.hasSuggestions=!0,$(this.$getDom()).find(".tag-field").addClass("has-suggestions"),res.$each((val,idx)=>{$(this.$getDom()).find(".suggestions").append(`<span>${val}</span>`)}),$(this.$getDom()).find(".suggestions").on("click",event=>{event.keyCode=13,event.target.value=$(event.target).text(),this.addTag(event)})},err=>{this.hasSuggestions=!1,$(this.$getDom()).find(".tag-field").removeClass("has-suggestions")})}catch(e){this.hasSuggestions=!1,$(this.$getDom()).find(".tag-field").removeClass("has-suggestions"),console.error("Tag search: bad onSearch function"),console.error(e)}}}function init(scope){$(window.document).on("click",function(event){Q.$isEmpty($(event.target).closest(`[awr-scope-id="${scope.$getScopeId()}"] .tag-field`))&&$(scope.$getDom()).find(".tag-field").removeClass("has-suggestions")})}$export(TagField),__callModuleMainFn__("function"==typeof $main?$main:null,__$$requires$$__)})}()}(window,jQuery);